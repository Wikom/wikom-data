!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("react"),require("prop-types"),require("react-redux"),require("react-loading"),require("superagent"),require("find-in-object"),require("react-symbol"),require("redux"),require("react-router-redux")):"function"==typeof define&&define.amd?define("wikomData",["react","prop-types","react-redux","react-loading","superagent","find-in-object","react-symbol","redux","react-router-redux"],r):"object"==typeof exports?exports.wikomData=r(require("react"),require("prop-types"),require("react-redux"),require("react-loading"),require("superagent"),require("find-in-object"),require("react-symbol"),require("redux"),require("react-router-redux")):e.wikomData=r(e.react,e["prop-types"],e["react-redux"],e["react-loading"],e.superagent,e["find-in-object"],e["react-symbol"],e.redux,e["react-router-redux"])}(this,function(e,r,t,n,a,u,o,i,l){return function(e){function r(n){if(t[n])return t[n].exports;var a=t[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.actions=r.userReducer=r.errorReducer=r.queriesReducer=r.dataReducer=r.ajaxErrorMiddleware=r.actionTypes=r.AppError=r.DataProvider=void 0;var u=t(1),o=a(u),i=t(10),l=a(i),c=t(9),s=n(c),d=t(6),f=n(d),p=t(12),A=a(p),m=t(13),_=a(m),b=t(15),y=a(b),g=t(16),v=a(g),D=t(18),O=a(D);r.default=o.default,r.DataProvider=o.default,r.AppError=l.default,r.actionTypes=s,r.ajaxErrorMiddleware=A.default,r.dataReducer=_.default,r.queriesReducer=y.default,r.errorReducer=v.default,r.userReducer=O.default,r.actions=f},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function u(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function l(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(r,"__esModule",{value:!0});var c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},s=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),d=t(2),f=n(d),p=t(3),A=n(p),m=t(4),_=t(5),b=n(_),y=t(6),g=function(e){function r(){return o(this,r),i(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return l(r,e),s(r,[{key:"componentDidMount",value:function(){this.props.force&&(this._pendingFetch=this.props.loadData({name:this.props.name,url:this.props.url}))}},{key:"componentWillReceiveProps",value:function(e){(this.props.force&&this.props.url!==e.url||e.refresh===!0)&&(this._pendingFetch&&this._pendingFetch.cancel(),this.props.clearData({name:this.props.name}),this._pendingFetch=this.props.loadData({name:e.name,url:e.url}))}},{key:"componentWillUnmount",value:function(){this._pendingFetch&&this._pendingFetch.cancel(),this.props.force&&this.props.clearData({name:this.props.name})}},{key:"render",value:function(){return this.props.onlyLoaded&&this.props.isLoading?f.default.createElement(b.default,null):f.default.createElement("span",null,this.props.children)}}]),r}(d.Component),v=function(e,r){var t=r.children,n=r.name,o=(r.url,r.force),i=r.dataProp,l=r.isLoadingProp,s=r.refresh,d=u(r,["children","name","url","force","dataProp","isLoadingProp","refresh"]);return{isLoading:!e.queries[n]||e.queries[n].isPending===!0,refresh:s||e.queries[n]&&e.queries[n].isQueued===!0,force:o||!e.queries[n]||e.queries[n].isComplete===!1,children:f.default.Children.map(t,function(r){var t;return f.default.cloneElement(r,c((t={},a(t,l,!e.queries[n]||e.queries[n].isPending===!0),a(t,i,e.data&&e.data[n]||null),a(t,"pagination",e.data&&e.data.pagination&&e.data.pagination[n]||null),t),d))})}},D=function(e){return{loadData:function(r){var t=r.name,n=r.url;return e((0,y.loadData)({name:t,url:n}))},clearData:function(r){var t=r.name;return e((0,y.clearData)({name:t}))}}},O=(0,m.connect)(v,D)(g);O.defaultProps={dataProp:"data",isLoadingProp:"isLoading",force:!1,refresh:!1,onlyLoaded:!1},O.propTypes={name:A.default.string.isRequired,url:A.default.string.isRequired,children:A.default.node.isRequired,dataProp:A.default.string,isLoadingProp:A.default.string,force:A.default.bool,refresh:A.default.bool,onlyLoaded:A.default.bool},r.default=O},function(r,t){r.exports=e},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r){e.exports=n},function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.loadData=r.clearPagination=r.setPagination=r.refreshData=r.clearData=r.loadDataProgress=r.loadDataCancel=r.loadDataFailure=r.loadDataSuccess=r.loadDataPending=r.types=r.del=r.put=r.post=r.get=r.baseRequest=r.configureRequest=r.setUser=void 0;var u=t(7),o=a(u),i=t(8),l=a(i),c=t(9),s=n(c),d=(r.setUser=function(e){var r=e.user;return{type:s.SET_USER,user:r}},{}),f=(r.configureRequest=function(){return function(e,r){var t=(0,l.default)("user.access_token",r());t&&(d.Accept="application/json",d.Authorization="Bearer "+t)}},r.baseRequest=function(e){var r=e.method,t=void 0===r?"GET":r,n=e.url;return(0,o.default)(t,n).set(d)}),p=r.get=function(e){var r=e.url;return f({url:r})};r.post=function(e){var r=e.url,t=e.data;return f({method:"POST",url:r}).send(t)},r.put=function(e){var r=e.url,t=e.data;return f({method:"PUT",url:r}).send(t)},r.del=function(e){var r=e.url;return f({method:"DELETE",url:r})};r.types=s;var A=r.loadDataPending=function(e){var r=e.name,t=e.url;return{type:s.LOAD_DATA_PENDING,name:r,url:t}},m=r.loadDataSuccess=function(e){var r=e.name,t=e.url,n=e.data;return{type:s.LOAD_DATA_SUCCESS,name:r,url:t,data:n}},_=r.loadDataFailure=function(e){var r=e.name,t=e.url,n=e.error;return{type:s.LOAD_DATA_FAILURE,name:r,url:t,error:n}},b=r.loadDataCancel=function(e){var r=e.name,t=e.url;return{type:s.LOAD_DATA_CANCEL,name:r,url:t}},y=r.loadDataProgress=function(e){var r=e.name,t=e.url,n=e.percent;return{type:s.LOAD_DATA_PROGRESS,name:r,url:t,percent:n}},g=(r.clearData=function(e){var r=e.name;return{type:s.CLEAR_DATA,name:r}},r.refreshData=function(e){var r=e.name;return{type:s.REFRESH_DATA,name:r}},r.setPagination=function(e){var r=e.name,t=e.data;return{type:s.SET_PAGINATION,name:r,data:t}}),v=r.clearPagination=function(e){var r=e.name;return{type:s.CLEAR_PAGINATION,name:r}};r.loadData=function(e){var r=e.name,t=e.url;return function(e,n){if(!n().queries.pending||n().queries.pending.indexOf(t)===-1){e(A({name:r,url:t}));var a=p({url:t}),u=a.on("progress",function(n){e(y({name:r,url:t,percent:n.percent||100}))}).then(function(n){if(u.cancel=function(){},n.ok&&n.body&&(e(m({name:r,url:t,data:n.body.data})),n.header["x-pagination-current-page"])){var a={currentPage:Number(n.header["x-pagination-current-page"]),pageCount:Number(n.header["x-pagination-page-count"]),perPage:Number(n.header["x-pagination-per-page"]),totalCount:Number(n.header["x-pagination-total-count"])};e(g({name:r,data:a}))}}).catch(function(n){e(_({name:r,url:t,error:n})),e(v({name:r}))});return u.cancel=function(){a.abort(),e(b({name:r,url:t}))},u}}}},function(e,r){e.exports=a},function(e,r){e.exports=u},function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t="@@wikom-data/";r.LOAD_DATA_PENDING=t+"LOAD_DATA_PENDING",r.LOAD_DATA_SUCCESS=t+"LOAD_DATA_SUCCESS",r.LOAD_DATA_FAILURE=t+"LOAD_DATA_FAILURE",r.LOAD_DATA_CANCEL=t+"LOAD_DATA_CANCEL",r.LOAD_DATA_PROGRESS=t+"LOAD_DATA_PROGRESS",r.CLEAR_DATA=t+"CLEAR_DATA",r.REFRESH_DATA=t+"REFRESH_DATA",r.SET_PAGINATION=t+"SET_PAGINATION",r.CLEAR_PAGINATION=t+"CLEAR_PAGINATION",r.SET_USER=t+"SET_USER"},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=t(2),u=n(a),o=t(3),i=n(o),l=t(4),c=t(11),s=n(c),d=function(e){var r=e.error;return u.default.createElement("div",{className:"alert alert-danger",id:"page-alert-danger",role:"alert"},u.default.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close"},u.default.createElement(s.default,{symbol:"times"})),u.default.createElement("h4",null,u.default.createElement(s.default,{symbol:{symbol:"ban",className:"icon"}}),r.status," ",r.name),u.default.createElement("ul",null,u.default.createElement("li",null,r.message)))},f=function(e){var r=e.errors;return r.length>0?u.default.createElement("div",null,r.map(function(e,r){return u.default.createElement(d,{key:r,error:e})})):null};f.defaultProps={errors:[]},f.propTypes={errors:i.default.arrayOf(i.default.object)};var p=function(e,r){return{errors:e.errors}},A=(0,l.connect)(p)(f);r.default=A},function(e,r){e.exports=o},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(6),a=function(e){return function(r){return function(r){return function(t){return t.type===n.types.LOAD_DATA_FAILURE&&401===t.error.status&&(location.href=e),r(t)}}}};r.default=a},function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}Object.defineProperty(r,"__esModule",{value:!0});var a=t(14),u=t(9),o=n(u),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=e?(0,a.combineReducers)(e):null;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1],a=Object.assign({},t);switch(n.type){case o.LOAD_DATA_SUCCESS:a[n.name]=n.data;break;case o.LOAD_DATA_FAILURE:a[n.name]=[];break;case o.CLEAR_DATA:delete a[n.name];break;case o.SET_PAGINATION:a.pagination||(a.pagination={}),a.pagination[n.name]=n.data;break;case o.CLEAR_PAGINATION:a.pagination||(a.pagination={}),a.pagination[n.name]={};break;default:a=t}if(r){var u=Object.keys(e).reduce(function(e,r){return e[r]=t[r],e},{});return Object.assign({},a,r(u,n))}return a}};r.default=i},function(e,r){e.exports=i},function(e,r,t){"use strict";function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object.defineProperty(r,"__esModule",{value:!0});var u=t(9),o=n(u),i=function(e){return{url:e,isQueued:!1,isPending:!0,isComplete:!1,percent:0}},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];switch(r.type){case o.LOAD_DATA_PENDING:return Object.assign({},e,a({},r.name,i(r.url)));case o.LOAD_DATA_SUCCESS:case o.LOAD_DATA_FAILURE:var t=e[r.name]?Object.assign({},e[r.name]):i(r.url);return t.isPending=!1,t.isComplete=!0,t.percent=100,Object.assign({},e,a({},r.name,t));case o.LOAD_DATA_CANCEL:var n=Object.assign({},e);return delete n[r.name],n;case o.LOAD_DATA_PROGRESS:var u=e[r.name]?Object.assign({},e[r.name]):i(r.url);return u.percent=r.percent,Object.assign({},e,a({},r.name,u));case o.REFRESH_DATA:var l=e[r.name]?Object.assign({},e[r.name]):i(r.url);return l.isQueued=!0,l.isPending=!1,l.isComplete=!1,l.percent=0,Object.assign({},e,a({},r.name,l));case o.CLEAR_DATA:var c=Object.assign({},e);return delete c[r.name],c;default:return e}};r.default=l},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=t(9),u=t(17),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments[1];switch(r.type){case a.LOAD_DATA_FAILURE:var t={status:0,name:"Unbekannter Fehler",message:"Es ist ein unbekannter Fehler aufgetreten."};return"object"===n(r.error)&&(t.status=r.error.status,"object"===n(r.error.response)&&"object"===n(r.error.response.body)&&(t.name=r.error.response.body.name,t.message=r.error.response.body.message)),e.concat(t);case u.LOCATION_CHANGE:return[];default:return e}};r.default=o},function(e,r){e.exports=l},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(9),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];switch(r.type){case n.SET_USER:return r.user;default:return e}};r.default=a}])});
//# sourceMappingURL=index.js.map